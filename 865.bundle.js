"use strict";(self.webpackChunkaleo_website=self.webpackChunkaleo_website||[]).push([[865],{9723:(r,t,e)=>{e.r(t),e.d(t,{Account:()=>o,Address:()=>p.Address,AleoKeyProvider:()=>h.Z,AleoKeyProviderParams:()=>h.p,AleoNetworkClient:()=>s,BlockHeightSearch:()=>u,CREDITS_PROGRAM_KEYS:()=>g,DevServerClient:()=>c,ExecutionResponse:()=>p.ExecutionResponse,KEY_STORE:()=>v,NetworkRecordProvider:()=>d,PRIVATE_TO_PUBLIC_TRANSFER:()=>w,PRIVATE_TRANSFER:()=>m,PRIVATE_TRANSFER_TYPES:()=>l,PUBLIC_TO_PRIVATE_TRANSFER:()=>P,PUBLIC_TRANSFER:()=>_,PrivateKey:()=>p.PrivateKey,PrivateKeyCiphertext:()=>p.PrivateKeyCiphertext,Program:()=>p.Program,ProgramManager:()=>f.L,ProgramManagerBase:()=>p.ProgramManager,ProvingKey:()=>p.ProvingKey,RecordCiphertext:()=>p.RecordCiphertext,RecordPlaintext:()=>p.RecordPlaintext,Signature:()=>p.Signature,VALID_TRANSFER_TYPES:()=>y,VerifyingKey:()=>p.VerifyingKey,ViewKey:()=>p.ViewKey,WasmTransaction:()=>p.Transaction,initThreadPool:()=>p.initThreadPool,initializeWasm:()=>b,logAndThrow:()=>E,verifyFunctionExecution:()=>p.verifyFunctionExecution});var i=e(7582);class o{constructor(r={}){try{this._privateKey=this.privateKeyFromParams(r)}catch(r){throw console.error("Wrong parameter",r),new Error("Wrong Parameter")}this._viewKey=p.ViewKey.from_private_key(this._privateKey),this._address=p.Address.from_private_key(this._privateKey)}static fromCiphertext(r,t){try{r="string"==typeof r?p.PrivateKeyCiphertext.fromString(r):r;const e=p.PrivateKey.fromPrivateKeyCiphertext(r,t);return new o({privateKey:e.to_string()})}catch(r){throw new Error("Wrong password or invalid ciphertext")}}privateKeyFromParams(r){return r.seed?p.PrivateKey.from_seed_unchecked(r.seed):r.privateKey?p.PrivateKey.from_string(r.privateKey):new p.PrivateKey}privateKey(){return this._privateKey}viewKey(){return this._viewKey}address(){return this._address}toString(){return this.address().to_string()}encryptAccount(r){return this._privateKey.toCiphertext(r)}decryptRecord(r){return this._viewKey.decrypt(r)}decryptRecords(r){return r.map((r=>this._viewKey.decrypt(r)))}ownsRecordCiphertext(r){if("string"!=typeof r)return r.isOwner(this._viewKey);try{return p.RecordCiphertext.fromString(r).isOwner(this._viewKey)}catch(r){return!1}}sign(r){return this._privateKey.sign(r)}verify(r,t){return this._address.verify(r,t)}}var n=e(7231);class s{constructor(r){this.host=r+"/testnet3"}setAccount(r){this.account=r}getAccount(){return this.account}setHost(r){this.host=r+"/testnet3"}fetchData(r="/"){return(0,i.mG)(this,void 0,void 0,(function*(){try{return(yield n.Z.get(this.host+r)).data}catch(r){throw new Error("Error fetching data.")}}))}findUnspentRecords(r,t,e,o,n,s){return(0,i.mG)(this,void 0,void 0,(function*(){if(s=s||[],r<0)throw new Error("Start height must be greater than or equal to 0");const i=new Array;let a,c,h,d,u=0,f=BigInt(0);if(void 0===e){if(void 0===this.account)throw new Error("Private key must be specified in an argument to findOwnedRecords or set in the AleoNetworkClient");h=this.account._privateKey}else try{h=e instanceof p.PrivateKey?e:p.PrivateKey.from_string(e)}catch(r){throw new Error("Error parsing private key provided.")}const v=h.to_view_key();try{const r=yield this.getLatestHeight();if("number"!=typeof r)throw new Error("Error fetching latest block height.");d=r}catch(r){throw new Error("Error fetching latest block height.")}if(c="number"==typeof t&&t<=d?t:d,r>c)throw new Error("Start height must be less than or equal to end height.");for(;c>r;){a=c-50,a<r&&(a=r);try{const r=yield this.getBlockRange(a,c);if(c=a,!(r instanceof Error))for(let t=0;t<r.length;t++){const e=r[t].transactions;if(void 0!==e)for(let r=0;r<e.length;r++){const t=e[r];if("execute"==t.type){const r=t.transaction;if(r.execution&&void 0!==r.execution.transitions)for(let t=0;t<r.execution.transitions.length;t++){const e=r.execution.transitions[t];if("credits.aleo"===e.program&&void 0!==e.outputs)for(let r=0;r<e.outputs.length;r++){const t=e.outputs[r];if("record"===t.type)try{const r=p.RecordCiphertext.fromString(t.value);if(r.isOwner(v)){const t=r.decrypt(v),e=t.nonce();if(s.includes(e))continue;const a=t.serialNumberString(h,"credits.aleo","credits");try{yield this.getTransitionId(a)}catch(r){if(!o&&(i.push(t),"number"==typeof n&&(f+=t.microcredits(),f>=BigInt(n))))return i;if(void 0!==o&&o.length>0){let r=0;if(t.microcredits()>o[r]){if(r+=1,i.push(t),"number"==typeof n&&(f+=t.microcredits(),f>=BigInt(n)))return i;if(i.length>=o.length)return i}}}}}catch(r){}}}}}}}catch(r){if(console.warn("Error fetching blocks in range: "+a.toString()+"-"+c.toString()),console.warn("Error: ",r),u+=1,u>10)return console.warn("10 failures fetching records reached. Returning records fetched so far"),i}}return i}))}getBlock(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/block/"+r)}catch(r){throw new Error("Error fetching block.")}}))}getBlockRange(r,t){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/blocks?start="+r+"&end="+t)}catch(e){throw new Error("Error fetching blocks between "+r+" and "+t+".")}}))}getLatestBlock(){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/latest/block")}catch(r){throw new Error("Error fetching latest block.")}}))}getLatestHash(){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/latest/hash")}catch(r){throw new Error("Error fetching latest hash.")}}))}getLatestHeight(){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/latest/height")}catch(r){throw new Error("Error fetching latest height.")}}))}getProgram(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/program/"+r)}catch(r){throw new Error("Error fetching program")}}))}getProgramObject(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return p.Program.fromString(r)}catch(t){try{return p.Program.fromString(yield this.getProgram(r))}catch(t){throw new Error(`${r} is neither a program name or a valid program`)}}}))}getProgramImports(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{const t={},e=(r instanceof p.Program?r:yield this.getProgramObject(r)).getImports();for(let r=0;r<e.length;r++){const i=e[r];if(!t.hasOwnProperty(i)){const r=yield this.getProgram(i),e=yield this.getProgramImports(i);for(const r in e)t.hasOwnProperty(r)||(t[r]=e[r]);t[i]=r}}return t}catch(r){throw E("Error fetching program imports: "+r)}}))}getProgramImportNames(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return(r instanceof p.Program?r:yield this.getProgramObject(r)).getImports()}catch(r){throw new Error("Error fetching program imports with error: "+r)}}))}getProgramMappingNames(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/program/"+r+"/mappings")}catch(r){throw new Error("Error fetching program mappings - ensure the program exists on chain before trying again")}}))}getProgramMappingValue(r,t,e){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/program/"+r+"/mapping/"+t+"/"+e)}catch(r){throw new Error("Error fetching mapping value - ensure the mapping exists and the key is correct")}}))}getStateRoot(){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/latest/stateRoot")}catch(r){throw new Error("Error fetching Aleo state root")}}))}getTransaction(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/transaction/"+r)}catch(r){throw new Error("Error fetching transaction.")}}))}getTransactions(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/block/"+r.toString()+"/transactions")}catch(r){throw new Error("Error fetching transactions.")}}))}getTransactionsInMempool(){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/memoryPool/transactions")}catch(r){throw new Error("Error fetching transactions from mempool.")}}))}getTransitionId(r){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.fetchData("/find/transitionID/"+r)}catch(r){throw new Error("Error fetching transition ID.")}}))}submitTransaction(r){return(0,i.mG)(this,void 0,void 0,(function*(){const t=r instanceof p.Transaction?r.toString():r;try{return(yield n.Z.post(this.host+"/transaction/broadcast",t,{headers:{"Content-Type":"application/json"}})).data}catch(r){const t=r;throw t.response?new Error(`Error posting transaction. Aleo network response: ${JSON.stringify(t.response.data)}`):t.request?new Error(`Error posting transaction. No response received: ${t.message}`):new Error(`Error setting up transaction request: ${t.message}`)}}))}}const a={headers:{"Content-type":"application/json; charset=UTF-8","Referrer-Policy":"no-referrer"}};class c{constructor(r){this.baseURL=r}sendRequest(r,t){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield n.Z.post(`${this.baseURL}/testnet3${r}`,t,a);if(!(e.statusText="200"))throw new Error(`Error sending request: ${e.statusText}`);return yield e.data}))}deployProgram(r,t,e,o,n){return(0,i.mG)(this,void 0,void 0,(function*(){const i={program:r,private_key:e,password:o,fee:1e6*t,fee_record:n};return yield this.sendRequest("/deploy",i)}))}executeProgram(r,t,e,o,n,s,a){return(0,i.mG)(this,void 0,void 0,(function*(){const i={program_id:r,program_function:t,inputs:o,private_key:n,password:s,fee:1e6*e,fee_record:a};return yield this.sendRequest("/execute",i)}))}transfer(r,t,e,o,n,s,a,c){return(0,i.mG)(this,void 0,void 0,(function*(){const i={amount:1e6*r,fee:1e6*t,transfer_type:o,recipient:e,private_key:n,password:s,fee_record:a,amount_record:c};return yield this.sendRequest("/transfer",i)}))}}var h=e(4693);class d{constructor(r,t){this.account=r,this.networkClient=t}setAccount(r){this.account=r}findCreditsRecords(r,t,e,o){return(0,i.mG)(this,void 0,void 0,(function*(){let t=0,i=0;if(o&&("startHeight"in o&&"number"==typeof o.endHeight&&(t=o.startHeight),"endHeight"in o&&"number"==typeof o.endHeight&&(i=o.endHeight)),0==i){const r=yield this.networkClient.getLatestHeight();if(r instanceof Error)throw E("Unable to get current block height from the network");i=r}if(t>=i)throw E("Start height must be less than end height");return yield this.networkClient.findUnspentRecords(t,i,this.account.privateKey(),r,void 0,e)}))}findCreditsRecord(r,t,e,o){return(0,i.mG)(this,void 0,void 0,(function*(){const i=yield this.findCreditsRecords([r],t,e,o);return!(i instanceof Error)&&i.length>0?i[0]:(console.error("Record not found with error:",i),new Error("Record not found"))}))}findRecord(r,t,e){return(0,i.mG)(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}findRecords(r,t,e){return(0,i.mG)(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}}class u{constructor(r,t){this.startHeight=r,this.endHeight=t}}var f=e(1037),p=e(1529);const v="https://testnet3.parameters.aleo.org/",g={transfer_private:{prover:v+"transfer_private.prover.2a9a6f2",verifier:v+"transfer_private.verifier.3a59762"},transfer_private_to_public:{prover:v+"transfer_private_to_public.prover.cf3b952",verifier:v+"transfer_private_to_public.verifier.5bd459b"},transfer_public:{prover:v+"transfer_public.prover.1117f0a",verifier:v+"transfer_public.verifier.d63af11"},transfer_public_to_private:{prover:v+"transfer_public_to_private.prover.7b763af",verifier:v+"transfer_public_to_private.verifier.25f6542"},join:{prover:v+"join.prover.da05baf",verifier:v+"join.verifier.1489109"},split:{prover:v+"split.prover.8c585f2",verifier:v+"split.verifier.8281688"},fee:{prover:v+"fee.prover.36542ce",verifier:v+"fee.verifier.2de311b"}},l=new Set(["transfer_private","private","transferPrivate","transfer_private_to_public","privateToPublic","transferPrivateToPublic"]),y=new Set(["transfer_private","private","transferPrivate","transfer_private_to_public","privateToPublic","transferPrivateToPublic","transfer_public","public","transferPublic","transfer_public_to_private","publicToPrivate","transferPublicToPrivate"]),m=new Set(["private","transfer_private","transferPrivate"]),w=new Set(["private_to_public","privateToPublic","transfer_private_to_public","transferPrivateToPublic"]),_=new Set(["public","transfer_public","transferPublic"]),P=new Set(["public_to_private","publicToPrivate","transfer_public_to_private","transferPublicToPrivate"]);function E(r){throw console.error(r),r}function b(){return(0,i.mG)(this,void 0,void 0,(function*(){return yield(0,p.default)()}))}}}]);
//# sourceMappingURL=865.bundle.js.map